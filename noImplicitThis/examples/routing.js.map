{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./examples/routing.js","webpack:///./src/routing/NominatimInputComponent.js","webpack:///./src/routing/NominatimService.js","webpack:///./src/routing/RoutingComponent.js","webpack:///./src/routing/RoutingFeatureComponent.js","webpack:///./src/routing/RoutingService.js","webpack:///./src/routing/module.js","webpack:///./src/routing/nominatiminput.html","webpack:///./src/routing/routing.html","webpack:///./src/routing/routingfeature.html"],"names":["module","angular","ngeoMapModule","name","ngeoRoutingModule","MainController","map","olMap","layers","olLayerTile","source","olSourceOSM","view","olView","center","zoom","routingfeatureActive","controller","ngeoSearchSearchDirective","ngeoRoutingNominatimService","run","$templateCache","put","require","value","$attrs","templateUrl","undefined","ngeoRoutingNominatimInputComponentTemplateUrl","Controller","$element","$scope","ngeoNominatimService","element_","$scope_","onSelect","inputValue","options","datasets","display","typeaheadSourceDebounced","listeners","select","select_","bind","placeholder","prototype","event","suggestion","dataset","routingNominatimInputComponent","bindings","component","NominatimService","$http","$injector","ngeoDebounce","$http_","ngeoDebounce_","nominatimUrl_","has","get","substr","searchDefaultParams_","typeaheadDebounceDelay_","typeaheadSource_","search","query","params","url","Object","assign","keys","option","push","join","reverse","coordinate","syncResults","asyncResults","onSuccess_","resp","parse","result","lon","lat","display_name","data","onError_","then","ngeoMiscDebounce","service","ngeoMiscFilters","ngeoRoutingRoutingService","ngeoRoutingRoutingFeatureComponent","ngeoRoutingTemplateUrl","ngeoRoutingService","$q","ngeoRoutingService_","ngeoNominatimService_","routingOptions_","routingProfiles","profiles","selectedRoutingProfile","length","$watch","calculateRoute","$q_","errorMessage","startFeature_","targetFeature_","viaArray","colors","routeSource_","olSourceVector","features","routeLayer_","olLayerVector","style","olStyleStyle","fill","olStyleFill","color","stroke","olStyleStroke","width","routeDistance","routeDuration","regexIsFormattedCoord","draw_","debounceDelay","handleChange","$onInit","addLayer","clearRoute","clear","getLonLatFromPoint_","point","geometry","getGeometry","coords","getCoordinates","projection","getView","getProjection","toLonLat","reverseRoute","tmpFeature","parseRoute_","route","parsedRoutes","format","olFormatGeoJSON","formatConfig","dataProjection","featureProjection","legs","leg","steps","step","olFeature","readGeometry","concat","coordFrom","coordTo","vias","filter","via","feature","routes","console","log","addFeatures","fit","getExtent","parseInt","distance","duration","startRoute","getCoordinateAt","endRoute","startToRoute","routeToEnd","routeConnections","olGeomLineString","config","when","getRoute","addVia","deleteVia","index","splice","ngeoRoutingNominatimInputComponent","ngeoRoutingFeatureTemplateUrl","$timeout","scope_","timeout_","featureLabel","fillColor","strokeColor","onChange","vectorFeatures_","olCollection","vectorSource_","vectorLayer_","resolution","text","olStyleText","font","offsetY","modifyFeature_","olInteractionModify","onSelect_","setActive","addInteraction","on","getArray","snapFeature_","newVal","oldVal","onFeatureChange_","$onDestroy","removeLayer","removeInteraction","set","olInteractionDraw","type","removeFeature","setFeature_","label","transformedCoordinate","olProj","olGeomPoint","addFeature","selected","parseFloat","newCoordinates","setCenter","coord","onSuccess","onError","routingFeatureComponent","RoutingService","ngeoOsrmBackendUrl_","backendUrl","protocolVersion_","coordinates","coordinateString","c","getNearest","ngeoRoutingRoutingComponent"],"mappings":";AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAiB,4BAA4B;AAC7C;AACA;AACA,0BAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAgB,uBAAuB;AACvC;;;AAGA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AChJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA,IAAMA,MAAM,GAAGC,8CAAO,CAACD,MAAR,CAAe,KAAf,EAAsB,CACnC,SADmC,EAEnCE,0DAAa,CAACC,IAFqB,EAGnCC,8DAAiB,CAACD,IAHiB,CAAtB,CAAf;;AAYA,SAASE,cAAT,GAA0B;AAKxB,OAAKC,GAAL,GAAW,IAAIC,iDAAJ,CAAU;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","file":"routing.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"routing\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([36,\"commons\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/**\n */\n\n/**\n * This example shows the ngeo routing directive.\n */\nimport './routing.css';\nimport 'ol/ol.css';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport '@fortawesome/fontawesome-free/css/fontawesome.min.css';\n\nimport angular from 'angular';\nimport ngeoMapModule from 'ngeo/map/module.js';\nimport ngeoRoutingModule from 'ngeo/routing/module.js';\nimport olMap from 'ol/Map.js';\nimport olView from 'ol/View.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olSourceOSM from 'ol/source/OSM.js';\n\n/** @type {!angular.IModule} **/\nconst module = angular.module('app', [\n  'gettext',\n  ngeoMapModule.name,\n  ngeoRoutingModule.name\n]);\n\n\n/**\n * The application's main directive.\n * @constructor\n * @ngInject\n */\nfunction MainController() {\n\n  /**\n   * @type {import(\"ol/Map.js\").default}\n   */\n  this.map = new olMap({\n    layers: [\n      new olLayerTile({\n        source: new olSourceOSM()\n      })\n    ],\n    view: new olView({\n      center: [931010.1535989442, 5961705.842297254],\n      zoom: 9\n    })\n  });\n\n  /**\n   * @type {boolean}\n   */\n  this.routingfeatureActive = true;\n}\n\nmodule.controller('MainController', MainController);\n\n\nexport default module;\n","import angular from 'angular';\nimport ngeoSearchSearchDirective from 'ngeo/search/searchDirective.js';\nimport ngeoRoutingNominatimService from 'ngeo/routing/NominatimService.js';\n\n\n/**\n * @type {!angular.IModule}\n * @hidden\n */\nconst module = angular.module('ngeoRoutingNominatimInputComponent', [\n  ngeoSearchSearchDirective.name,\n  ngeoRoutingNominatimService.name\n]);\n\nmodule.run(/* @ngInject */ ($templateCache) => {\n  // @ts-ignore: webpack\n  $templateCache.put('ngeo/routing/nominatiminput', require('./nominatiminput.html'));\n});\n\n\nmodule.value('ngeoRoutingNominatimInputComponentTemplateUrl',\n  /**\n   * @param {!angular.IAttributes} $attrs Attributes.\n   * @return {string} Template URL.\n   */\n  ($attrs) => {\n    const templateUrl = $attrs['ngeoRoutingNominatimInputComponentTemplateUrl'];\n    return templateUrl !== undefined ? templateUrl :\n      'ngeo/routing/nominatiminput';\n  }\n);\n\n\n/**\n * @param {!angular.IAttributes} $attrs Attributes.\n * @param {!function(!angular.IAttributes): string} ngeoRoutingNominatimInputComponentTemplateUrl\n *    Template function.\n * @return {string} Template URL.\n * @ngInject\n * @private\n * @hidden\n */\nfunction ngeoRoutingNominatimInputComponentTemplateUrl(\n  $attrs, ngeoRoutingNominatimInputComponentTemplateUrl\n) {\n  return ngeoRoutingNominatimInputComponentTemplateUrl($attrs);\n}\n\n\n/**\n * @param {!JQuery} $element Element.\n * @param {!angular.IScope} $scope Scope.\n * @param {!import(\"ngeo/routing/NominatimService.js\").NominatimService} ngeoNominatimService service for\n *    Nominatim\n * @constructor\n * @private\n * @hidden\n * @ngInject\n * @ngdoc controller\n * @ngname NgeoNominatimInputController\n */\nfunction Controller($element, $scope, ngeoNominatimService) {\n\n  /**\n   * @type {!JQuery}\n   * @private\n   */\n  this.element_ = $element;\n\n  /**\n   * @type {angular.IScope}\n   * @private\n   */\n  this.$scope_ = $scope;\n\n  /**\n   * @type {import(\"ngeo/routing/NominatimService.js\").NominatimService}\n   */\n  this.ngeoNominatimService = ngeoNominatimService;\n\n  /**\n   * @type {(function(Object): void|undefined)}\n   */\n  this.onSelect;\n\n  /**\n   * @type {string}\n   */\n  this.inputValue;\n\n  /**\n   * @type {Twitter.Typeahead.Options}\n   */\n  this.options = /** @type {Twitter.Typeahead.Options} */ ({\n  });\n\n  /**\n   * @type {Array.<Twitter.Typeahead.Dataset>}\n   */\n  this.datasets = [/** @type {Twitter.Typeahead.Dataset} */({\n    name: 'nominatim',\n    display: 'name',\n    source: this.ngeoNominatimService.typeaheadSourceDebounced,\n  })];\n\n  /**\n   * @type {import('ngeo/search/searchDirective.js').SearchDirectiveListeners}\n   */\n  this.listeners = /** @type {import('ngeo/search/searchDirective.js').SearchDirectiveListeners} */({\n    select: this.select_.bind(this)\n  });\n\n  /**\n   * @type {string}\n   */\n  this.placeholder = '';\n\n}\n\n/**\n * @param {JQueryEventObject} event Event.\n * @param {import('ngeo/routing/NominatimService').NominatimSearchResult} suggestion Suggestion.\n * @param {Twitter.Typeahead.Dataset} dataset Dataset.\n * @private\n * @hidden\n */\nController.prototype.select_ = function(event, suggestion, dataset) {\n  if (this.onSelect) {\n    this.onSelect(suggestion);\n  }\n};\n\n/**\n * Input form field which provides Nominatim typeahead lookup using\n * {@link import(\"ngeo/routing/NominatimService.js\").default}.\n *\n * Example:\n *\n *     <ngeo-nominatim-input\n *         ngeo-nominatim-input-value=\"ctrl.label\"\n *         ngeo-nominatim-input-placeholder=\"type to search\"\n *         ngeo-nominatim-input-on-select=\"ctrl.onSelect\">\n *\n * Is used in in the partial of {@link import(\"ngeo/routingFeatureComponent.js\").default}.\n *\n * See the [../examples/routing.html](../examples/routing.html) example to see it in action.\n *\n * @htmlAttribute {function(import('ngeo/routing/NominatimService').NominatimSearchResult)}\n *    ngeo-nominatim-input-on-select Event fired when user selects a new suggestion.\n * @htmlAttribute {string} ngeo-nominatim-input-value\n *  Value of input field, will be set to the label of the search result.\n * @htmlAttribute {string} ngeo-nominatim-input-placeholder\n *  Placeholder text, when field is empty.\n * @ngdoc directive\n * @ngname ngeoNominatimInput\n */\nconst routingNominatimInputComponent = {\n  controller: Controller,\n  bindings: {\n    'onSelect': '=?ngeoNominatimInputOnSelect',\n    'inputValue': '=?ngeoNominatimInputValue',\n    'placeholder': '@?ngeoNominatimInputPlaceholder'\n  },\n  templateUrl: ngeoRoutingNominatimInputComponentTemplateUrl\n};\n\nmodule.component('ngeoNominatimInput', routingNominatimInputComponent);\n\n\nexport default module;\n","/* eslint max-len: [\"error\", { \"code\": 110, \"ignoreComments\": true }] */\n\nimport angular from 'angular';\nimport ngeoMiscDebounce from 'ngeo/misc/debounce.js';\n\n\n/**\n * @typedef {Object} NominatimSearchResult\n * @property {string} name\n * @property {string} label\n * @property {import(\"ol/coordinate.js\").Coordinate} coordinate\n */\n\n\n/**\n * @typedef {Object} NominatimSearchResponseResult\n * @property {string} display_name\n * @property {number} lon\n * @property {number} lat\n */\n\n\n/**\n * Service to provide access to Nominatim, which allows to search for\n * OSM data by name and address.\n * @param {angular.IHttpService} $http Angular http service.\n * @param {angular.auto.IInjectorService} $injector Main injector.\n * @param {import(\"ngeo/misc/debounce.js\").miscDebounce<function(string, function(Array<Object>): void, function(Array<NominatimSearchResult>): void): void>}  ngeoDebounce\n *    ngeo Debounce service.\n * @constructor\n * @ngdoc service\n * @ngInject\n * @ngname ngeoNominatimService\n * @see https://wiki.openstreetmap.org/wiki/Nominatim\n * @hidden\n */\nexport function NominatimService($http, $injector, ngeoDebounce) {\n\n  /**\n   * @type {angular.IHttpService}\n   * @private\n   */\n  this.$http_ = $http;\n\n  /**\n   * @type {import(\"ngeo/misc/debounce.js\").miscDebounce<function(string, function(Array<Object>): void, function(Array<NominatimSearchResult>): void): void>}\n   * @private\n   */\n  this.ngeoDebounce_ = ngeoDebounce;\n\n  /**\n   * URL for Nominatim backend\n   * Defaults openstreetmap instance.\n   * @type {string}\n   * @private\n   */\n  this.nominatimUrl_ = 'https://nominatim.openstreetmap.org/';\n\n  if ($injector.has('ngeoNominatimUrl')) {\n    this.nominatimUrl_ = $injector.get('ngeoNominatimUrl');\n\n    // the url is expected to end with a slash\n    if (this.nominatimUrl_.substr(-1) !== '/') {\n      this.nominatimUrl_ += '/';\n    }\n  }\n\n  /**\n   * @type {Object<string, string>}\n   * @private\n   */\n  this.searchDefaultParams_ = {};\n\n  if ($injector.has('ngeoNominatimSearchDefaultParams')) {\n    this.searchDefaultParams_ = $injector.get('ngeoNominatimSearchDefaultParams');\n  }\n\n  /**\n   * Delay (in milliseconds) to avoid calling the API too often.\n   * Only if there were no calls for that many milliseconds,\n   * the last call will be executed.\n   * @type {number}\n   * @private\n   */\n  this.typeaheadDebounceDelay_ = 500;\n\n  /**\n   * @type {function(string, function(Array<Object>): void, function(Array<NominatimSearchResult>): void): void}\n   */\n  this.typeaheadSourceDebounced =\n    this.ngeoDebounce_(this.typeaheadSource_.bind(this), this.typeaheadDebounceDelay_, true);\n}\n\n/**\n * Search by name\n * @param {string} query Search query\n * @param {?Object} params Optional parameters\n * @return {!angular.IHttpPromise<Object>} promise of the Nominatim API request\n * @see https://wiki.openstreetmap.org/wiki/Nominatim#Search\n */\nNominatimService.prototype.search = function(query, params) {\n  let url = `${this.nominatimUrl_}search?q=${query}`;\n\n  params = params || {};\n  params = Object.assign({}, this.searchDefaultParams_, params);\n\n  // require JSON response\n  params['format'] = 'json';\n\n  if (params) {\n    url += '&';\n    const options = [];\n    for (const option of Object.keys(params)) {\n      options.push(`${option}=${params[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n/**\n * Reverse Geocoding\n * @param {import(\"ol/coordinate.js\").Coordinate} coordinate Search coordinate in LonLat projection\n * @param {(Object|undefined)} params Optional parameters\n * @return {!angular.IHttpPromise<Object>} promise of the Nominatim API request\n * @see https://wiki.openstreetmap.org/wiki/Nominatim#Reverse_Geocoding\n */\nNominatimService.prototype.reverse = function(coordinate, params) {\n  let url = `${this.nominatimUrl_}reverse`;\n\n  params = Object.assign({}, params);\n\n  // coordinate\n  params['lon'] = coordinate[0];\n  params['lat'] = coordinate[1];\n\n  // require JSON response\n  params['format'] = 'json';\n\n  if (params) {\n    url += '?';\n    const options = [];\n    for (const option of Object.keys(params)) {\n      options.push(`${option}=${params[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n/**\n * @param {string} query Search query\n * @param {function(Array<Object>): void} syncResults Callback for synchronous execution, unused\n * @param {function(Array<NominatimSearchResult>): void} asyncResults Callback for asynchronous execution\n * @private\n */\nNominatimService.prototype.typeaheadSource_ = function(query, syncResults, asyncResults) {\n  const onSuccess_ = function(resp) {\n    /**\n     * Parses result response.\n     * @param {NominatimSearchResponseResult} result Result\n     * @return {NominatimSearchResult} Parsed result\n     */\n    const parse = function(result) {\n      return /** @type {NominatimSearchResult} */({\n        coordinate: [result.lon, result.lat],\n        name: result.display_name\n      });\n    };\n    asyncResults(resp.data.map(parse));\n  };\n\n  const onError_ = function(resp) {\n    asyncResults([]);\n  };\n\n  this.search(query, {}).then(onSuccess_, onError_);\n};\n\n\n/**\n * @type {!angular.IModule}\n * @hidden\n */\nconst module = angular.module('ngeoNominatimService', [\n  ngeoMiscDebounce.name\n]);\n\nmodule.service('ngeoNominatimService', NominatimService);\n\n\nexport default module;\n","import angular from 'angular';\nimport ngeoMiscDebounce from 'ngeo/misc/debounce.js';\nimport ngeoMiscFilters from 'ngeo/misc/filters.js';\nimport ngeoRoutingNominatimService from 'ngeo/routing/NominatimService.js';\nimport ngeoRoutingRoutingService from 'ngeo/routing/RoutingService.js';\nimport ngeoRoutingRoutingFeatureComponent from 'ngeo/routing/RoutingFeatureComponent.js';\nimport olFormatGeoJSON from 'ol/format/GeoJSON.js';\nimport olSourceVector from 'ol/source/Vector.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olStyleStyle from 'ol/style/Style.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport {toLonLat} from 'ol/proj.js';\nimport olFeature from 'ol/Feature.js';\nimport olGeomLineString from 'ol/geom/LineString.js';\nimport 'ngeo/sass/font.scss';\n\n\n/**\n * @typedef {Object} RoutingVia\n * @property {?import(\"ol/Feature.js\").default} feature\n * @property {function(import('ngeo/routing/NominatimService').NominatimSearchResult)} onSelect\n */\n\n\n/**\n * @type {!angular.IModule}\n * @hidden\n */\nconst module = angular.module('ngeoRoutingComponent', [\n  ngeoMiscDebounce.name,\n  ngeoMiscFilters.name,\n  ngeoRoutingNominatimService.name,\n  ngeoRoutingRoutingService.name,\n  ngeoRoutingRoutingFeatureComponent.name\n]);\n\n\nmodule.run(/* @ngInject */ ($templateCache) => {\n  // @ts-ignore: webpack\n  $templateCache.put('ngeo/routing/routing', require('./routing.html'));\n});\n\n\nmodule.value('ngeoRoutingTemplateUrl',\n  /**\n   * @param {!angular.IAttributes} $attrs Attributes.\n   * @return {string} Template URL.\n   */\n  ($attrs) => {\n    const templateUrl = $attrs['ngeoRoutingTemplateUrl'];\n    return templateUrl !== undefined ? templateUrl :\n      'ngeo/routing/routing';\n  }\n);\n\n\n/**\n * @param {!angular.IAttributes} $attrs Attributes.\n * @param {!function(!angular.IAttributes): string} ngeoRoutingTemplateUrl Template function.\n * @return {string} Template URL.\n * @ngInject\n * @private\n * @hidden\n */\nfunction ngeoRoutingTemplateUrl($attrs, ngeoRoutingTemplateUrl) {\n  return ngeoRoutingTemplateUrl($attrs);\n}\n\n\n/**\n * The controller for the routing directive.\n * @param {angular.auto.IInjectorService} $injector Main injector.\n * @param {!angular.IScope} $scope Scope.\n * @param {!import(\"ngeo/routing/RoutingService.js\").RoutingService} ngeoRoutingService service for OSRM\n *    routing.\n * @param {!import(\"ngeo/routing/NominatimService.js\").NominatimService} ngeoNominatimService service for\n *    Nominatim.\n * @param {!angular.IQService} $q Angular q service\n * @param {import(\"ngeo/misc/debounce.js\").miscDebounce<function(): void>} ngeoDebounce ngeo Debounce service.\n * @constructor\n * @private\n * @hidden\n * @ngInject\n * @ngdoc controller\n * @ngname NgeoRoutingController\n */\nclass Controller {\n  constructor($injector, $scope, ngeoRoutingService, ngeoNominatimService, $q, ngeoDebounce) {\n\n    /**\n     * @type {angular.IScope}\n     * @private\n     */\n    this.$scope_ = $scope;\n\n    /**\n     * @type {import(\"ngeo/routing/RoutingService.js\").RoutingService}\n     * @private\n     */\n    this.ngeoRoutingService_ = ngeoRoutingService;\n\n    /**\n     * @type {import(\"ngeo/routing/NominatimService.js\").NominatimService}\n     * @private\n     */\n    this.ngeoNominatimService_ = ngeoNominatimService;\n\n    /**\n     * @type {import('ngeo/routing/RoutingService').RoutingOptions}\n     * @private\n     */\n    this.routingOptions_ = $injector.has('ngeoRoutingOptions') ? $injector.get('ngeoRoutingOptions') : {};\n\n    /**\n     * Available routing profiles.\n     * Example: [\n     *            {\n     *              label: 'Car', // used as label in the UI\n     *              profile: 'routed-car' // used as part of the query\n     *            }\n     *          ]\n     * @type {Array<import('ngeo/routing/RoutingService').RoutingProfile>}\n     */\n    this.routingProfiles = this.routingOptions_.profiles || [];\n\n    /**\n     * @type {?import('ngeo/routing/RoutingService').RoutingProfile}\n     */\n    this.selectedRoutingProfile = this.routingProfiles.length > 0 ? this.routingProfiles[0] : null;\n\n    $scope.$watch(\n      () => this.selectedRoutingProfile,\n      this.calculateRoute.bind(this)\n    );\n\n    /**\n     * @type {angular.IQService}\n     * @private\n     */\n    this.$q_ = $q;\n\n    /**\n     * @type {import(\"ol/Map.js\").default}\n     */\n    this.map;\n\n    /**\n     * @type {string}\n     */\n    this.errorMessage = '';\n\n    /**\n     * @type {import(\"ol/Feature.js\").default}\n     */\n    this.startFeature_ = null;\n\n    /**\n     * @type {import(\"ol/Feature.js\").default}\n     */\n    this.targetFeature_ = null;\n\n    /**\n     * @type {Array.<RoutingVia>}\n     */\n    this.viaArray = [];\n\n    /**\n     * @type {Object<string, string>}\n     */\n    this.colors = {\n      'start.fill': '#6BE62E',\n      'start.stroke': '#4CB01E',\n      'destination.fill': '#FF3E13',\n      'destination.stroke': '#CD3412',\n      'via.fill': '#767676',\n      'via.stroke': '#000000'\n    };\n\n    /**\n     * @type {import(\"ol/source/Vector.js\").default}\n     * @private\n     */\n    this.routeSource_ = new olSourceVector({\n      features: []\n    });\n\n    /**\n     * @type {import(\"ol/layer/Vector.js\").default}\n     * @private\n     */\n    this.routeLayer_ = new olLayerVector({\n      source: this.routeSource_,\n      style: new olStyleStyle({\n        fill: new olStyleFill({\n          color: 'rgba(16, 112, 29, 0.6)'\n        }),\n        stroke: new olStyleStroke({\n          color: 'rgba(16, 112, 29, 0.6)',\n          width: 5\n        })\n      })\n    });\n\n    /**\n     * Distance of route in meters\n     * @type {number}\n     */\n    this.routeDistance = 0;\n\n    /**\n     * Duration of route in minutes.\n     * @type {?number}\n     */\n    this.routeDuration = null;\n\n    /**\n     * @type {RegExp}\n     * @private\n     */\n    this.regexIsFormattedCoord = /\\d+\\.\\d+\\/\\d+\\.\\d+/;\n\n    /**\n     * @type {import(\"ol/interaction/Draw.js\").default}\n     * @private\n     */\n    this.draw_ = null;\n\n    const debounceDelay = 200; // in milliseconds\n\n    /**\n     * Debounced because in some cases (reverse route) multiple changes are done\n     * at once and spam this function.\n     * @type {function(): void}\n     */\n    this.handleChange = ngeoDebounce(this.calculateRoute.bind(this), debounceDelay, true);\n  }\n\n  /**\n   * Init the controller\n   */\n  $onInit() {\n    this.map.addLayer(this.routeLayer_);\n  }\n\n  /**\n   * Clears start, end and vias. Removes features from map.\n   */\n  clearRoute() {\n    this.startFeature_ = null;\n    this.targetFeature_ = null;\n    this.viaArray = [];\n    this.routeDistance = 0;\n    this.routeDuration = null;\n    this.routeSource_.clear();\n    this.errorMessage = '';\n  }\n\n  /**\n   * Converts feature point into LonLat coordinate.\n   * @param {import(\"ol/Feature.js\").default} point Feature point to convert\n   * @return {import(\"ol/coordinate.js\").Coordinate} LonLat coordinate\n   * @private\n   */\n  getLonLatFromPoint_(point) {\n    const geometry = /** @type {import(\"ol/geom/Point.js\").default} */ (point.getGeometry());\n    const coords = geometry.getCoordinates();\n    const projection = this.map.getView().getProjection();\n    return toLonLat(coords, projection);\n  }\n\n  /**\n   * Flip start and target and re-calculate route.\n   */\n  reverseRoute() {\n    // swap start and target\n    const tmpFeature = this.startFeature_;\n    this.startFeature_ = this.targetFeature_;\n    this.targetFeature_ = tmpFeature;\n\n    // reverse vias\n    this.viaArray = this.viaArray.reverse();\n\n    // recalculation is done by the debounced handleChange\n  }\n\n  /**\n   * @param {Object} route Routes of OSRM response\n   * @returns {Array<import(\"ol/Feature.js\").default>} parsed route features\n   * @private\n   */\n  parseRoute_(route) {\n    let parsedRoutes = [];\n    const format = new olFormatGeoJSON();\n    const formatConfig = {\n      dataProjection: 'EPSG:4326',\n      featureProjection: this.map.getView().getProjection()\n    };\n    // if there are is useful \"legs\" data, parse this\n    if (route.legs) {\n      parsedRoutes = route.legs.map(leg => leg.steps.map(step => new olFeature({\n        geometry: format.readGeometry(step.geometry, formatConfig)\n      })));\n      // flatten\n      parsedRoutes = [].concat(...parsedRoutes);\n    } else if (route.geometry) {\n    // otherwise parse (overview) geometry\n      parsedRoutes.push(new olFeature({geometry: format.readGeometry(route.geometry, formatConfig)}));\n    }\n    return parsedRoutes;\n  }\n\n  /**\n   */\n  calculateRoute() {\n    if (this.startFeature_ && this.targetFeature_) {\n      // remove rendered routes\n      this.routeSource_.clear();\n\n      const coordFrom = this.getLonLatFromPoint_(this.startFeature_);\n      const coordTo = this.getLonLatFromPoint_(this.targetFeature_);\n      const vias = this.viaArray.filter(via => via.feature !== null).map(\n        via => this.getLonLatFromPoint_(via.feature)\n      );\n      const route = [coordFrom].concat(vias, [coordTo]);\n\n      const onSuccess_ = (resp) => {\n        const features = this.parseRoute_(resp.data.routes[0]);\n        if (features.length === 0) {\n          console.log('No route or not supported format.');\n          return;\n        }\n        this.routeSource_.addFeatures(features);\n\n        // recenter map on route\n        this.map.getView().fit(this.routeSource_.getExtent());\n\n        this.routeDistance = parseInt(resp.data.routes[0].distance, 10);\n        this.routeDuration = resp.data.routes[0].duration;\n\n        // get first and last coordinate of route\n        const startRoute = /** @type{import(\"ol/geom/LineString.js\").default} */(\n          features[0].getGeometry()\n        ).getCoordinateAt(0);\n        const endRoute = /** @type{import(\"ol/geom/LineString.js\").default} */(\n          features[features.length - 1].getGeometry()\n        ).getCoordinateAt(1);\n\n        // build geometries to connect route to start and end point of query\n        const startToRoute = [/** @type {import(\"ol/geom/Point.js\").default} */(\n          this.startFeature_.getGeometry()\n        ).getCoordinates(), startRoute];\n        const routeToEnd = [endRoute, /** @type {import(\"ol/geom/Point.js\").default} */(\n          this.targetFeature_.getGeometry()\n        ).getCoordinates()];\n        const routeConnections = [\n          new olFeature(new olGeomLineString(startToRoute)),\n          new olFeature(new olGeomLineString(routeToEnd))\n        ];\n\n        // add them to the source\n        this.routeSource_.addFeatures(routeConnections);\n      };\n\n      const onError_ = (resp) => {\n        this.errorMessage = 'Error: routing server not responding.';\n        console.log(resp);\n      };\n\n      const options = {};\n      options['steps'] = true;\n      options['overview'] = false;\n      options['geometries'] = 'geojson';\n\n      const config = {};\n      config['options'] = options;\n\n      if (this.selectedRoutingProfile) {\n        config['instance'] = this.selectedRoutingProfile['profile'];\n      }\n\n      this.$q_.when(this.ngeoRoutingService_.getRoute(route, config))\n        .then(onSuccess_, onError_);\n    }\n  }\n\n  /**\n   */\n  addVia() {\n    this.viaArray.push(/** @type{RoutingVia} */({\n      feature: null,\n      onSelect: null\n    }));\n  }\n\n  /**\n   * @param {number} index Array index.\n   */\n  deleteVia(index) {\n    if (this.viaArray.length > index) {\n      this.viaArray.splice(index, 1);\n      this.calculateRoute();\n    }\n  }\n}\n\n\nmodule.component('ngeoRouting', {\n  controller: Controller,\n  bindings: {\n    'map': '<ngeoRoutingMap'\n  },\n  templateUrl: ngeoRoutingTemplateUrl\n});\n\n\nexport default module;\n","import angular from 'angular';\nimport ngeoRoutingNominatimService from 'ngeo/routing/NominatimService.js';\nimport ngeoRoutingNominatimInputComponent from 'ngeo/routing/NominatimInputComponent.js';\nimport * as olProj from 'ol/proj.js';\nimport olFeature from 'ol/Feature.js';\nimport olCollection from 'ol/Collection.js';\nimport olSourceVector from 'ol/source/Vector.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olStyleStyle from 'ol/style/Style.js';\nimport olStyleText from 'ol/style/Text.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport olGeomPoint from 'ol/geom/Point.js';\nimport olInteractionModify from 'ol/interaction/Modify.js';\nimport olInteractionDraw from 'ol/interaction/Draw.js';\nimport 'ngeo/sass/font.scss';\n\n\n/**\n * @type {!angular.IModule}\n * @hidden\n */\nconst module = angular.module('ngeoRoutingFeatureComponent', [\n  ngeoRoutingNominatimService.name,\n  ngeoRoutingNominatimInputComponent.name\n]);\n\nmodule.run(/* @ngInject */ ($templateCache) => {\n  // @ts-ignore: webpack\n  $templateCache.put('ngeo/routing/routingfeature', require('./routingfeature.html'));\n});\n\n\nmodule.value('ngeoRoutingFeatureTemplateUrl',\n  /**\n   * @param {!angular.IAttributes} $attrs Attributes.\n   * @return {string} Template URL.\n   */\n  ($attrs) => {\n    const templateUrl = $attrs['ngeoRoutingFeatureTemplateUrl'];\n    return templateUrl !== undefined ? templateUrl :\n      'ngeo/routing/routingfeature';\n  }\n);\n\n/**\n * @param {!angular.IAttributes} $attrs Attributes.\n * @param {!function(!angular.IAttributes): string} ngeoRoutingFeatureTemplateUrl Template function.\n * @return {string} Template URL.\n * @ngInject\n * @private\n * @hidden\n */\nfunction ngeoRoutingFeatureTemplateUrl($attrs, ngeoRoutingFeatureTemplateUrl) {\n  return ngeoRoutingFeatureTemplateUrl($attrs);\n}\n\n\n/**\n * @param {!angular.IScope} $scope Angular scope.\n * @param {angular.ITimeoutService} $timeout Angular timeout service.\n * @param {!angular.IQService} $q Angular q service\n * @param {!import(\"ngeo/routing/NominatimService.js\").NominatimService} ngeoNominatimService service for\n *    Nominatim\n * @constructor\n * @private\n * @hidden\n * @ngInject\n * @ngdoc controller\n * @ngname NgeoRoutingFeatureController\n */\nclass Controller {\n\n  constructor($scope, $timeout, $q, ngeoNominatimService) {\n\n    /**\n     * @type {!angular.IScope}\n     * @private\n     */\n    this.scope_ = $scope;\n\n    /**\n     * @type {angular.ITimeoutService}\n     * @private\n     */\n    this.timeout_ = $timeout;\n\n    /**\n     * @type {angular.IQService}\n     * @private\n     */\n    this.$q_ = $q;\n\n    /**\n     * @type {import(\"ngeo/routing/NominatimService.js\").NominatimService}\n     * @private\n     */\n    this.ngeoNominatimService_ = ngeoNominatimService;\n\n    /**\n     * @type {import(\"ol/Map.js\").default}\n     * @private\n     */\n    this.map;\n\n    /**\n     * @type {import(\"ol/Feature.js\").default}\n     */\n    this.feature;\n\n    /**\n     * @type {string}\n     */\n    this.featureLabel = '';\n\n    /**\n     * @type {string}\n     */\n    this.fillColor;\n\n    /**\n     * @type {string}\n     */\n    this.strokeColor;\n\n    /**\n     * @type {function(import(\"ol/Feature.js\").default): void}\n     */\n    this.onChange;\n\n    /**\n     * @type {import(\"ol/Collection.js\").default}\n     * @private\n     */\n    this.vectorFeatures_ = new olCollection();\n\n    /**\n     * @type {import(\"ol/source/Vector.js\").default}\n     * @private\n     */\n    this.vectorSource_ = new olSourceVector({\n      features: this.vectorFeatures_\n    });\n\n    /**\n     * @type {import(\"ol/layer/Vector.js\").default}\n     * @private\n     */\n    this.vectorLayer_ = new olLayerVector({\n      source: this.vectorSource_,\n      style: ((feature, resolution) => {\n        return [new olStyleStyle({\n          text: new olStyleText({\n            fill: new olStyleFill({\n              color: this.fillColor || '#000000'\n            }),\n            font: '900 30px \"Font Awesome 5 Free\"',\n            offsetY: -15,\n            stroke: new olStyleStroke({\n              width: 3,\n              color: this.strokeColor || '#000000'\n            }),\n            text: '\\uf041'\n          })\n        })];\n      })\n    });\n\n    /**\n     * Interaction for moving start and end.\n     * @type {import(\"ol/interaction/Modify.js\").default}\n     * @private\n     */\n    this.modifyFeature_ = new olInteractionModify({\n      features: this.vectorFeatures_\n    });\n\n    /**\n     * @type {import(\"ol/interaction/Draw.js\").default}\n     * @private\n     */\n    this.draw_ = null;\n\n    /**\n     * @param {import('ngeo/routing/NominatimService').NominatimSearchResult} selected Selected result.\n     */\n    this.onSelect = this.onSelect_.bind(this);\n\n    /**\n     * @type {string}\n     */\n    this.errorMessage = '';\n  }\n\n  $onInit() {\n    this.map.addLayer(this.vectorLayer_);\n\n    // setup modify interaction\n    this.modifyFeature_.setActive(true);\n    this.map.addInteraction(this.modifyFeature_);\n\n    this.modifyFeature_.on('modifyend', (event) => {\n      const feature = event.features.getArray()[0];\n      this.vectorSource_.clear();\n      this.snapFeature_(feature);\n    });\n\n    this.scope_.$watch(\n      () => this.feature,\n      (newVal, oldVal) => {\n        if (newVal) {\n          this.onFeatureChange_();\n        }\n        if (newVal === null) {\n          this.vectorSource_.clear();\n          this.featureLabel = '';\n        }\n      }\n    );\n  }\n\n  /**\n   * Cleanup, mostly relevant for vias.\n   */\n  $onDestroy() {\n    this.map.removeLayer(this.vectorLayer_);\n    this.modifyFeature_.setActive(false);\n    this.map.removeInteraction(this.modifyFeature_);\n  }\n\n  /**\n   */\n  set() {\n    if (this.draw_) {\n      this.map.removeInteraction(this.draw_);\n    }\n\n    this.draw_ = new olInteractionDraw({\n      features: this.vectorFeatures_,\n      type: /** @type {import(\"ol/geom/GeometryType.js\").default} */ ('Point')\n    });\n\n    this.draw_.on('drawstart', () => {\n      if (this.feature) {\n        this.vectorSource_.removeFeature(this.feature);\n      }\n    });\n\n    this.draw_.on('drawend', (event) => {\n      if (this.draw_) {\n        this.map.removeInteraction(this.draw_);\n      }\n      this.snapFeature_(event.feature);\n      this.modifyFeature_.setActive(true);\n    });\n\n    this.modifyFeature_.setActive(false);\n    this.map.addInteraction(this.draw_);\n  }\n\n  /**\n   * @param {import(\"ol/coordinate.js\").Coordinate} coordinate LonLat coordinate.\n   * @param {string} label Feature name/label.\n   * @private\n   */\n  setFeature_(coordinate, label) {\n    const transformedCoordinate = olProj.fromLonLat(coordinate, this.map.getView().getProjection());\n    if (label === '') {\n      label = transformedCoordinate.join('/');\n    }\n    this.feature = new olFeature({\n      geometry: new olGeomPoint(transformedCoordinate),\n      name: label\n    });\n  }\n\n  onFeatureChange_() {\n    // update label\n    this.featureLabel = /** @type{string} */(this.feature.get('name') || '');\n\n    //update vector source\n    this.vectorSource_.clear();\n    this.vectorSource_.addFeature(this.feature);\n\n    // notify others\n    if (this.onChange) {\n      this.timeout_(() => {\n        this.onChange(this.feature);\n      });\n    }\n  }\n\n  /**\n   * @param {import('ngeo/routing/NominatimService').NominatimSearchResult} selected Selected result.\n   * @private\n   */\n  onSelect_(selected) {\n    // @ts-ignore: If types are not respected\n    const coordinate = selected.coordinate.map(parseFloat);\n    const label = selected.label;\n    this.setFeature_(coordinate, label);\n    const newCoordinates = /** @type{import(\"ol/geom/Point.js\").default} */(this.feature.getGeometry())\n      .getCoordinates();\n    this.map.getView().setCenter(newCoordinates);\n  }\n\n  /**\n   * Snaps a feature to the street network using the getNearest\n   * function of the routing service. Replaces the feature.\n   * @param {import(\"ol/Feature.js\").default} feature Feature to snap\n   * @private\n   */\n  snapFeature_(feature) {\n    const coord = this.getLonLatFromPoint_(feature);\n    const config = {};\n\n    const onSuccess = (resp) => {\n      const lon = parseFloat(resp['data']['lon']);\n      const lat = parseFloat(resp['data']['lat']);\n      const coordinate = [lon, lat];\n      const label = resp['data']['display_name'];\n      this.setFeature_(coordinate, label);\n    };\n\n    const onError = (resp) => {\n      this.errorMessage = 'Error: nominatim server not responding.';\n      console.log(resp);\n    };\n\n    this.$q_.when(this.ngeoNominatimService_.reverse(coord, config))\n      .then(onSuccess, onError);\n  }\n\n  /**\n   * Converts feature point into LonLat coordinate.\n   * @param {import(\"ol/Feature.js\").default} point Feature point to convert\n   * @return {import(\"ol/coordinate.js\").Coordinate} LonLat coordinate\n   * @private\n   */\n  getLonLatFromPoint_(point) {\n    const geometry = /** @type {import(\"ol/geom/Point.js\").default} */ (point.getGeometry());\n    const coords = geometry.getCoordinates();\n    const projection = this.map.getView().getProjection();\n    return olProj.toLonLat(coords, projection);\n  }\n}\n\n\n/**\n * Provides a text input and draw interaction to allow a user to create and modify a ol.Feature\n * (point geometry).\n *\n * The text input is provided by {@link import(\"ngeo/nominatimInputComponent.js\").default} and includes\n * Nominatim search.\n *\n * Example:\n *\n *     <ngeo-routing-feature\n *         ngeo-routing-feature-map=\"ctrl.map\"\n *         ngeo-routing-feature-feature=\"ctrl.feature\"\n *         ngeo-routing-feature-fill-color=\"#6BE62E\"\n *         ngeo-routing-feature-stroke-color=\"#4CB01E\"\n *         ngeo-routing-feature-on-change=\"ctrl.handleChange\">\n *\n * Is used in in the partial of {@link import(\"ngeo/routingComponent.js\").default}.\n *\n * See the [../examples/routing.html](../examples/routing.html) example for a usage sample.\n *\n * @htmlAttribute {import(\"ol/Map.js\").default} ngeo-routing-feature-map The map.\n * @htmlAttribute {import(\"ol/Feature.js\").default} ngeo-routing-feature-feature The feature.\n * @htmlAttribute {string} ngeo-routing-feature-fill-color The marker fill color.\n * @htmlAttribute {string} ngeo-routing-feature-stroke-color The marker stroke color.\n * @htmlAttribute {function(import(\"ol/Feature.js\").default)} ngeo-routing-feature-on-change Event fired when\n *    feature changes.\n * @ngdoc directive\n * @ngname ngeoRoutingFeature\n */\nconst routingFeatureComponent = {\n  controller: Controller,\n  bindings: {\n    'map': '<ngeoRoutingFeatureMap',\n    'feature': '=ngeoRoutingFeatureFeature',\n    'fillColor': '<?ngeoRoutingFeatureFillColor',\n    'strokeColor': '<?ngeoRoutingFeatureStrokeColor',\n    'onChange': '=?ngeoRoutingFeatureOnChange'\n  },\n  templateUrl: ngeoRoutingFeatureTemplateUrl\n};\n\nmodule.component('ngeoRoutingFeature', routingFeatureComponent);\n\n\nexport default module;\n","import angular from 'angular';\n\n\n/**\n * @typedef {Object} RoutingProfile\n * @property {string} label\n * @property {string} profile\n */\n\n\n/**\n * @typedef {Object} RoutingOptions\n * @property {string} [backendUrl]\n * @property {Array.<RoutingProfile>} [profiles]\n */\n\n\n/**\n * Service to provide access to a\n * [Open Source Routing Machine (OSRM) backend](https://github.com/Project-OSRM/osrm-backend)\n * of version 5.8 and higher and its features.\n * @param {angular.IHttpService} $http Angular http service.\n * @param {angular.auto.IInjectorService} $injector Main injector.\n * @constructor\n * @ngdoc service\n * @ngInject\n * @ngname ngeoRoutingService\n * @hidden\n */\nexport function RoutingService($http, $injector) {\n\n  /**\n   * @type {angular.IHttpService}\n   * @private\n   */\n  this.$http_ = $http;\n\n  /**\n   * @type {RoutingOptions}\n   * @private\n   */\n  this.routingOptions_ = $injector.has('ngeoRoutingOptions') ? $injector.get('ngeoRoutingOptions') : {};\n\n  /**\n   * URL for OSRM backend API.\n   * Defaults to demo backend.\n   * @type {string}\n   * @private\n   */\n  this.ngeoOsrmBackendUrl_ = this.routingOptions_.backendUrl || 'https://router.project-osrm.org/';\n\n  // the url is expected to end with a slash\n  if (this.ngeoOsrmBackendUrl_.substr(-1) !== '/') {\n    this.ngeoOsrmBackendUrl_ += '/';\n  }\n\n  /**\n   * Version of the protocol implemented by the service.\n   * see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md\n   * @type {string}\n   * @private\n   */\n  this.protocolVersion_ = 'v1';\n\n}\n\n/**\n * Route request\n * @param {Array.<import(\"ol/coordinate.js\").Coordinate>} coordinates coordinates of the route (at least two!)\n * @param {?Object} config optional configuration\n * @return {!angular.IHttpPromise<Object>} promise of the OSRM API request\n */\nRoutingService.prototype.getRoute = function(coordinates, config) {\n\n  config = config || {};\n\n  // Service\n  // see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#requests\n  if (!config['service']) {\n    config['service'] = 'route'; // default to route\n  }\n\n  // Mode of transportation,\n  // can be: car, bike, foot\n  // see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#requests\n  //\n  // As of version 5.8.0, OSRM (server) does not support multiple profiles simultaneously.\n  // This means the value actually does not matter.\n  if (!config['profile']) {\n    config['profile'] = 'car'; // default to car\n  }\n\n  // build request URL\n  let url = this.ngeoOsrmBackendUrl_;\n\n  // Common workaround to provide multiple profiles (since it is not supported yet)\n  // Every profile runs on its own instance.\n  if (config['instance']) {\n    url += `${config['instance']}/`;\n  }\n\n  url += `${config['service']}/${this.protocolVersion_}/${config['profile']}/`;\n\n  // [ [a,b] , [c,d] ] -> 'a,b;c,d'\n  const coordinateString = coordinates.map(c => c.join(',')).join(';');\n\n  url += coordinateString;\n\n  // look for route service options\n  // see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#route-service\n  if (config.options) {\n    url += '?';\n    const options = [];\n    for (const option of Object.keys(config.options)) {\n      options.push(`${option}=${config.options[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n/**\n * Snaps a coordinate to the street network and returns the nearest match\n * @param {import(\"ol/coordinate.js\").Coordinate} coordinate coordinate to query\n * @param {?Object} config optional configuration\n * @return {!angular.IHttpPromise<Object>} promise of the OSRM API request\n * @see https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#nearest-service\n */\nRoutingService.prototype.getNearest = function(coordinate, config) {\n  config = config || {};\n\n  // service is always nearest\n  config['service'] = 'nearest';\n\n  // Mode of transportation\n  // If used in combination with a getRoute request, choose the same profile.\n  if (!config['profile']) {\n    config['profile'] = 'car'; // default to car\n  }\n\n  // build request URL\n  let url = this.ngeoOsrmBackendUrl_;\n\n  // Common workaround to provide multiple profiles (since it is not supported yet)\n  // Every profile runs on its own instance.\n  if (config['instance']) {\n    url += `${config['instance']}/`;\n  }\n\n  url += `${config['service']}/${this.protocolVersion_}/${config['profile']}/`;\n\n  // [a,b] -> 'a,b'\n  const coordinateString = coordinate.join(',');\n  url += coordinateString;\n\n  // look for nearest service options\n  if (config.options) {\n    url += '?';\n    const options = [];\n    for (const option of Object.keys(config.options)) {\n      options.push(`${option}=${config.options[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n\n/**\n * @type {!angular.IModule}\n * @hidden\n */\nconst module = angular.module('ngeoRoutingService', [\n]);\n\nmodule.service('ngeoRoutingService', RoutingService);\n\n\nexport default module;\n","import angular from 'angular';\nimport ngeoRoutingRoutingComponent from 'ngeo/routing/RoutingComponent.js';\n\nimport './routing.scss';\n\n/**\n * @type {angular.IModule}\n */\nexport default angular.module('ngeoRoutingModule', [\n  ngeoRoutingRoutingComponent.name\n]);\n","module.exports = function(obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<div class=\"ngeo-nominatim-input\">\\n  <input type=\"text\"\\n         class=\"form-control\"\\n         placeholder=\"{{$ctrl.placeholder}}\"\\n         ng-model=\"$ctrl.inputValue\"\\n         ngeo-search=\"$ctrl.options\"\\n         ngeo-search-datasets=\"$ctrl.datasets\"\\n         ngeo-search-listeners=\"$ctrl.listeners\">\\n</div>\\n';\n\n}\nreturn __p\n}","module.exports = function(obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<div class=\"ngeo-routing\">\\n  <div class=\"ngeo-routing-start form-group\">\\n    <ngeo-routing-feature\\n      ngeo-routing-feature-map=\"$ctrl.map\"\\n      ngeo-routing-feature-feature=\"$ctrl.startFeature_\"\\n      ngeo-routing-feature-fill-color=\"$ctrl.colors[\\'start.fill\\']\"\\n      ngeo-routing-feature-stroke-color=\"$ctrl.colors[\\'start.stroke\\']\"\\n      ngeo-routing-feature-on-change=\"$ctrl.handleChange\">\\n    </ngeo-routing-feature>\\n  </div>\\n\\n    <div class=\"ngeo-routing-vias form-group\" ng-repeat=\"(index, via) in $ctrl.viaArray\">\\n      <div class=\"form-inline\">\\n        <div class=\"form-group\">\\n          <ngeo-routing-feature\\n            ngeo-routing-feature-map=\"$ctrl.map\"\\n            ngeo-routing-feature-feature=\"via.feature\"\\n            ngeo-routing-feature-fill-color=\"$ctrl.colors[\\'via.fill\\']\"\\n            ngeo-routing-feature-stroke-color=\"$ctrl.colors[\\'via.stroke\\']\"\\n            ngeo-routing-feature-on-change=\"$ctrl.handleChange\">\\n          </ngeo-routing-feature>\\n        </div>\\n        <button type=\"button\" class=\"btn prime delete-via\" ng-click=\"$ctrl.deleteVia(index)\">\\n          <span class=\"fa fa-trash\"></span>\\n        </button>\\n      </div>\\n    </div>\\n\\n  <div class=\"ngeo-routing-destination form-group\">\\n    <ngeo-routing-feature\\n      ngeo-routing-feature-map=\"$ctrl.map\"\\n      ngeo-routing-feature-feature=\"$ctrl.targetFeature_\"\\n      ngeo-routing-feature-fill-color=\"$ctrl.colors[\\'destination.fill\\']\"\\n      ngeo-routing-feature-stroke-color=\"$ctrl.colors[\\'destination.stroke\\']\"\\n      ngeo-routing-feature-on-change=\"$ctrl.handleChange\">\\n    </ngeo-routing-feature>\\n  </div>\\n\\n  <div class=\"form-group fill\">\\n    <button type=\"button\" class=\"btn prime\" ng-click=\"$ctrl.clearRoute()\">\\n      <span class=\"fa fa-trash\"></span> <span translate>Clear</span>\\n    </button>\\n    <button type=\"button\" class=\"btn prime\" ng-click=\"$ctrl.reverseRoute()\">\\n      <span class=\"fa fa-exchange-alt\"></span> <span translate>Reverse</span>\\n    </button>\\n    <button type=\"button\" class=\"btn prime\" ng-click=\"$ctrl.addVia()\">\\n      <span class=\"fa fa-plus\"></span> <span translate>Add via</span>\\n    </button>\\n  </div>\\n\\n  <div class=\"clearfix\"></div>\\n\\n  <div ng-if=\"$ctrl.routingProfiles.length > 1\">\\n    <div class=\"form-group\">\\n      <label class=\"col-form-label col-md-4\" translate>Profile</label>\\n      <div class=\"col-md-8\">\\n        <select class=\"form-control\" ng-model=\"$ctrl.selectedRoutingProfile\">\\n          <option ng-repeat=\"profile in $ctrl.routingProfiles\" ng-value=\"profile\">{{profile.label}}</option>\\n        </select>\\n      </div>\\n    </div>\\n  </div>\\n\\n  <div class=\"ngeo-routing-error form-group clearfix\"\\n       ng-hide=\"$ctrl.errorMessage === \\'\\'\">\\n    {{$ctrl.errorMessage}}\\n  </div>\\n\\n  <div class=\"clearfix\"></div>\\n\\n  <div ng-hide=\"$ctrl.routeDuration === null && $ctrl.routeDistance <= 0\">\\n    <div class=\"row\">\\n      <div class=\"col-md-12\">\\n        <strong translate>Route statistics</strong>\\n      </div>\\n    </div>\\n    <div class=\"row\" ng-hide=\"$ctrl.routeDuration === null\">\\n      <div class=\"col-md-4 text-right\" translate>\\n        Duration\\n      </div>\\n      <div class=\"col-md-8\">\\n        {{$ctrl.routeDuration | ngeoDuration}}\\n      </div>\\n    </div>\\n\\n    <div class=\"row\" ng-hide=\"$ctrl.routeDistance <= 0\">\\n      <div class=\"col-md-4 text-right\" translate>\\n        Distance\\n      </div>\\n      <div class=\"col-md-8\">\\n        {{$ctrl.routeDistance | ngeoUnitPrefix:\\'m\\'}}\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n';\n\n}\nreturn __p\n}","module.exports = function(obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<div class=\"ngeo-routing-feature\">\\n    <div class=\"input-group\">\\n      <ngeo-nominatim-input\\n        ngeo-nominatim-input-value=\"$ctrl.featureLabel\"\\n        ngeo-nominatim-input-placeholder=\"{{\\'Search...\\' | translate}}\"\\n        ngeo-nominatim-input-on-select=\"$ctrl.onSelect\">\\n      </ngeo-nominatim-input>\\n      <div class=\"input-group-addon btn\" ng-click=\"$ctrl.set()\">\\n        <span class=\"fa fa-map-marker\"></span>\\n      </div>\\n    </div>\\n</div>\\n';\n\n}\nreturn __p\n}"],"sourceRoot":""}